@page "/iotcomponents/data/{Id:int}"
@using Microsoft.Extensions.Localization
@using Syncfusion.Blazor.Charts
@inherits BaseGrowComponent
@attribute [Authorize]
@inject IStringLocalizer<AppResources> Localizer

<div class="container">
    <div class="row">
        <div class="col">
            <h1>@Localizer["Component data"]</h1>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><NavLink href="/">@Localizer["Home"]</NavLink></li>
                    <li class="breadcrumb-item"><NavLink href="/iotcomponents">@Localizer["Components"]</NavLink></li>
                    <li class="breadcrumb-item active" aria-current="page">@Localizer["Component data"]</li>
                </ol>
            </nav>
            <div class="card mt-4">
                <div class="card-body">
                    @if (IsLoading)
                    {
                        <div class="spinner-border mx-auto d-block" role="status">
                            <span class="sr-only">@Localizer["Loading"]...</span>
                        </div>
                    }
                    <div class="row">
                        <div class="col-12 text-center ">
                            <h3>@Localizer["Real-time data"]</h3>
                            <div class="d-flex flex-column justify-content-center align-content-center">
                                <SfChart @ref="HistoryChart"
                                         Width="100%"
                                         Height="450px"
                                         DataSource="@HistoryData">
                                    <ChartPrimaryXAxis Title="Time"
                                                       ValueType="Syncfusion.Blazor.Charts.ValueType.DateTime" />
                                    <ChartPrimaryYAxis ValueType="@YAxisType"
                                                       Maximum="@Maximum"
                                                       Minimum="@Minimum" />

                                    <ChartTooltipSettings Enable="true" Format="${series.name} ${point.x} : ${point.y} ">
                                    </ChartTooltipSettings>

                                    <ChartSeriesCollection>
                                        <ChartSeries XName="X" YName="Y" PointColorMapping="ColorY" Fill="#0277BD" Type="@ChartType">
                                            @if (_isInitialized)
                                            {
                                                <ChartSeriesAnimation Enable="false" />
                                            }

                                            <ChartMarker Visible="true">
                                                <ChartDataLabel Visible="true" Name="TextY" />
                                            </ChartMarker>
                                        </ChartSeries>
                                        <ChartSeries XName="X" YName="Y2" PointColorMapping="ColorY2" Fill="#F57C00" Type="@ChartType">
                                            @if (_isInitialized)
                                            {
                                                <ChartSeriesAnimation Enable="false" />
                                            }
                                            <ChartMarker Visible="true">
                                                <ChartDataLabel Visible="true" Name="TextY2" />
                                            </ChartMarker>
                                        </ChartSeries>
                                    </ChartSeriesCollection>
                                </SfChart>
                            </div>

                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

